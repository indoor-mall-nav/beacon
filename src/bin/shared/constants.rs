pub const MAX_PACKET_SIZE: usize = 512;

pub const DEVICE_INQUIRY: u8 = 0x01;
pub const DEVICE_RESPONSE: u8 = 0x02;
pub const NONCE_REQUEST: u8 = 0x03;
pub const NONCE_RESPONSE: u8 = 0x04;
pub const PROOF_SUBMISSION: u8 = 0x05;
pub const UNLOCK_RESULT: u8 = 0x06;

pub const UNLOCK_FAILURE: u8 = 0x00;
pub const UNLOCK_SUCCESS: u8 = 0x01;

pub const IDENTIFIER_LENGTH: usize = 1;
pub const NONCE_LENGTH: usize = 16;
/// ObjectId as used in MongoDB, 12 bytes
pub const DEVICE_LENGTH: usize = 12;
pub const CHALLENGE_HASH_LENGTH: usize = 32;
pub const DEVICE_SIGNATURE_LENGTH: usize = 64;
pub const TIMESTAMP_LENGTH: usize = 8;
pub const COUNTER_LENGTH: usize = 8;
pub const UNLOCK_LENGTH: usize = 1;
pub const UNLOCK_REASON_LENGTH: usize = 1;

pub const DEVICE_INQUIRY_LENGTH: usize = IDENTIFIER_LENGTH;
pub const DEVICE_RESPONSE_LENGTH: usize = IDENTIFIER_LENGTH + DEVICE_LENGTH;
pub const NONCE_REQUEST_LENGTH: usize = IDENTIFIER_LENGTH;
pub const NONCE_RESPONSE_LENGTH: usize = IDENTIFIER_LENGTH + NONCE_LENGTH;
pub const PROOF_SUBMISSION_LENGTH: usize = IDENTIFIER_LENGTH
    + CHALLENGE_HASH_LENGTH
    + DEVICE_SIGNATURE_LENGTH
    + TIMESTAMP_LENGTH
    + COUNTER_LENGTH;
pub const UNLOCK_RESULT_LENGTH: usize = IDENTIFIER_LENGTH + UNLOCK_LENGTH + UNLOCK_REASON_LENGTH;

pub const CHALLENGE_HASH_OFFSET: usize = IDENTIFIER_LENGTH;
pub const DEVICE_SIGNATURE_OFFSET: usize = IDENTIFIER_LENGTH + CHALLENGE_HASH_LENGTH;
pub const TIMESTAMP_OFFSET: usize =
    IDENTIFIER_LENGTH + CHALLENGE_HASH_LENGTH + DEVICE_SIGNATURE_LENGTH;
pub const COUNTER_OFFSET: usize =
    IDENTIFIER_LENGTH + CHALLENGE_HASH_LENGTH + DEVICE_SIGNATURE_LENGTH + TIMESTAMP_LENGTH;

pub const MAX_ATTEMPTS: u8 = 5;
